<div class='content'>
  <h3 i18n='welcome text|welcome text device table component@@welcome_devices_table'>
    Welcome to baggage
    {{login_information['username']}} !</h3>
  <h5 style='max-width: 60%;' i18n='short description@@short_description_devices_table'>
    Baggage allows you to visualize the performance data of your devices. Select a device in the table
    below, once the device is selected choose the data you wish to view and then click on the "view" button.
  </h5>
  <h2 i18n='title your devices|@@title_your_devices_table'>Your devices</h2>
  <div class='table_container'>
    <mat-form-field>
      <mat-label i18n='search text|tip text for seach input in device table@@search_tip_devices_table'>Type here to
        search for a specific device</mat-label>
      <input matInput (keyup)='applyFilter($event)' placeholder='Ex. Citybox' #input>
    </mat-form-field>

    <table mat-table [dataSource]='dataSource' multiTemplateDataRows class='mat-elevation-z1' matSort>
      <ng-container matColumnDef='{{column.key}}' *ngFor='let column of columnsToDisplay; let colIndex = index'>
        <th mat-header-cell *matHeaderCellDef mat-sort-header class='row'> {{column[site_language]}} </th>
        <td mat-cell *matCellDef='let box' class='row'> {{box[column.key]}} </td>
      </ng-container>

      <ng-container matColumnDef='expandedDetail'>
        <td mat-cell *matCellDef='let box' [attr.colspan]='columnsToDisplay.length'>
          <div class='element-detail' [@detailExpand]="box == expandedElement ? 'expanded' : 'collapsed'">
            <div class='element-description'>
              <mat-grid-list cols='4' rowHeight='60px'>
                <mat-grid-tile colspan='1' [style.background]='green'
                  i18n='tip text|tip text wich explain how the table work@@tip_text_description_devices_table'>
                  In order to consult the collected data , select the data you wish to consult and then click on the
                  "Visualize" button.
                </mat-grid-tile>
                <!-- Selection groups / box -->
                <mat-grid-tile colspan='1'>
                  <mat-radio-group [(ngModel)]='option' aria-label='Select an option'>
                    <mat-radio-button class='radio' color='primary' value='group' [checked]='true'
                      (change)='radioChange($event)'>Group</mat-radio-button>
                    <mat-radio-button class='radio' color='primary' value='box' [checked]='false'
                      (change)='radioChange($event)'>Box</mat-radio-button>
                  </mat-radio-group>
                </mat-grid-tile>
                <!-- Graph selection -->
                <mat-grid-tile colspan='2' [style.background]='blue'>
                  <mat-form-field appearance='legacy' style='width:35%;'>
                    <mat-label
                      i18n='title of metric selection|title of metric selection@@title_metric_selection_devices_table'>
                      Graph available</mat-label>
                    <mat-select [formControl]='graphs_form' (selectionChange)='onChange($event)'
                      (openedChange)=clearfilter() multiple>
                      <mat-form-field class="full-width">
                        <mat-label
                          i18n='text for search metric|text used in search metric input@@search_metric_input_devices_table'>
                          search for metric</mat-label>
                        <input class='input' [(ngModel)]="filterName" matInput type="text"
                          (keyup)="filterListCareUnit($event.target.value)">
                      </mat-form-field>
                      <mat-option *ngFor='let graph_available of graphs_available_list' value='{{graph_available}}'>
                        {{graph_available}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                  <button mat-flat-button [disabled]='_disabled_visualize' color='primary' (click)='Visualize()'
                    class='visualize_btn'
                    i18n='text visualize button|text used in visualize button in devices table@@button_visualize_devices_table'>Visualize</button>
                </mat-grid-tile>
              </mat-grid-list>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef='columnsToDisplayKeys'></tr>
      <tr mat-row *matRowDef='let box; columns: columnsToDisplayKeys;' class='element-row'
        [class.expanded-row]='expandedElement === box' (click)='expandedElement = expandedElement === box ? null : box '
        (click)='get_group_info(box)'>
      </tr>
      <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class='detail-row'></tr>
    </table>
    <mat-paginator [pageSizeOptions]='[5, 25, 50, 75, 100]'></mat-paginator>
  </div>

  <app-graph *ngIf='_show_graph;' [information]=information_dad></app-graph>
</div>